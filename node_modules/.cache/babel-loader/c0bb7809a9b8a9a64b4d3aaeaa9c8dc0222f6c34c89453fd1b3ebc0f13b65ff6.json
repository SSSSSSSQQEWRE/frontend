{"ast":null,"code":"var _jsxFileName = \"/home/ervin-caravali-ibarra/Downloads/frontend-v2/src/components/ManualQuestionForm.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useAuth } from '../AuthContext'; // ✅ Importar el contexto de autenticación\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ManualQuestionForm = ({\n  topics,\n  onQuestionCreated,\n  onCancel\n}) => {\n  _s();\n  const {\n    user\n  } = useAuth(); // ✅ Ahora obtenemos el usuario desde el contexto\n  const [question, setQuestion] = useState('');\n  const [options, setOptions] = useState(['', '', '', '']);\n  const [correctIndex, setCorrectIndex] = useState(0);\n  const [selectedTopic, setSelectedTopic] = useState(topics[0] || '');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const handleOptionChange = (idx, value) => {\n    const newOptions = [...options];\n    newOptions[idx] = value;\n    setOptions(newOptions);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setError('');\n\n    // Validaciones\n    if (!question.trim() || options.some(opt => !opt.trim())) {\n      setError('Completa la pregunta y todas las opciones.');\n      return;\n    }\n\n    // Validar autenticación\n    if (!user || !user.getIdToken) {\n      setError('Debes iniciar sesión para crear preguntas.');\n      return;\n    }\n    setLoading(true);\n    try {\n      const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:5000';\n\n      // Obtener token del usuario autenticado\n      let token = await user.getIdToken();\n      const payload = {\n        text: question,\n        options,\n        correctAnswerIndex: correctIndex,\n        category: selectedTopic,\n        explanation: ''\n      };\n      const res = await fetch(`${apiBase}/api/questions`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify(payload)\n      });\n      const data = await res.json();\n      if (res.ok && data.success !== false) {\n        // ✅ Llamar al callback para notificar que la pregunta fue creada\n        onQuestionCreated && onQuestionCreated(data.question || {\n          question,\n          options,\n          correctAnswerIndex: correctIndex,\n          category: selectedTopic\n        });\n      } else {\n        setError(data.error || 'Error al guardar la pregunta');\n      }\n    } catch (err) {\n      setError('Error de conexión');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"manual-question-form\",\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Agregar pregunta manual\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: [\"Tema:\", /*#__PURE__*/_jsxDEV(\"select\", {\n        value: selectedTopic,\n        onChange: e => setSelectedTopic(e.target.value),\n        children: topics.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: t,\n          children: t\n        }, t, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 28\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: [\"Pregunta:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: question,\n        onChange: e => setQuestion(e.target.value),\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Opciones:\", options.map((opt, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: opt,\n          onChange: e => handleOptionChange(idx, e.target.value),\n          required: true,\n          placeholder: `Opción ${idx + 1}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: \"correctOption\",\n            checked: correctIndex === idx,\n            onChange: () => setCorrectIndex(idx)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 15\n          }, this), \"Correcta\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this)]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"manual-question-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: onCancel,\n        disabled: loading,\n        children: \"Cancelar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: loading,\n        children: loading ? 'Guardando...' : 'Guardar pregunta'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this);\n};\n_s(ManualQuestionForm, \"As9uuwdqrDpcAc6sc2T6w50A1Tk=\", false, function () {\n  return [useAuth];\n});\n_c = ManualQuestionForm;\nexport default ManualQuestionForm;\nvar _c;\n$RefreshReg$(_c, \"ManualQuestionForm\");","map":{"version":3,"names":["React","useState","useAuth","jsxDEV","_jsxDEV","ManualQuestionForm","topics","onQuestionCreated","onCancel","_s","user","question","setQuestion","options","setOptions","correctIndex","setCorrectIndex","selectedTopic","setSelectedTopic","error","setError","loading","setLoading","handleOptionChange","idx","value","newOptions","handleSubmit","e","preventDefault","trim","some","opt","getIdToken","apiBase","process","env","REACT_APP_API_URL","token","payload","text","correctAnswerIndex","category","explanation","res","fetch","method","headers","Authorization","body","JSON","stringify","data","json","ok","success","err","className","onSubmit","children","fileName","_jsxFileName","lineNumber","columnNumber","onChange","target","map","t","type","required","placeholder","name","checked","onClick","disabled","_c","$RefreshReg$"],"sources":["/home/ervin-caravali-ibarra/Downloads/frontend-v2/src/components/ManualQuestionForm.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useAuth } from '../AuthContext';  // ✅ Importar el contexto de autenticación\n\nconst ManualQuestionForm = ({ topics, onQuestionCreated, onCancel }) => {\n  const { user } = useAuth();  // ✅ Ahora obtenemos el usuario desde el contexto\n  const [question, setQuestion] = useState('');\n  const [options, setOptions] = useState(['', '', '', '']);\n  const [correctIndex, setCorrectIndex] = useState(0);\n  const [selectedTopic, setSelectedTopic] = useState(topics[0] || '');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const handleOptionChange = (idx, value) => {\n    const newOptions = [...options];\n    newOptions[idx] = value;\n    setOptions(newOptions);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n\n    // Validaciones\n    if (!question.trim() || options.some(opt => !opt.trim())) {\n      setError('Completa la pregunta y todas las opciones.');\n      return;\n    }\n\n    // Validar autenticación\n    if (!user || !user.getIdToken) {\n      setError('Debes iniciar sesión para crear preguntas.');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:5000';\n\n      // Obtener token del usuario autenticado\n      let token = await user.getIdToken();\n\n      const payload = {\n        text: question,\n        options,\n        correctAnswerIndex: correctIndex,\n        category: selectedTopic,\n        explanation: ''\n      };\n\n      const res = await fetch(`${apiBase}/api/questions`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify(payload)\n      });\n\n      const data = await res.json();\n\n      if (res.ok && data.success !== false) {\n        // ✅ Llamar al callback para notificar que la pregunta fue creada\n        onQuestionCreated && onQuestionCreated(\n          data.question || { question, options, correctAnswerIndex: correctIndex, category: selectedTopic }\n        );\n      } else {\n        setError(data.error || 'Error al guardar la pregunta');\n      }\n    } catch (err) {\n      setError('Error de conexión');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form className=\"manual-question-form\" onSubmit={handleSubmit}>\n      <h3>Agregar pregunta manual</h3>\n\n      <label>\n        Tema:\n        <select value={selectedTopic} onChange={e => setSelectedTopic(e.target.value)}>\n          {topics.map(t => <option key={t} value={t}>{t}</option>)}\n        </select>\n      </label>\n\n      <label>\n        Pregunta:\n        <input \n          type=\"text\" \n          value={question} \n          onChange={e => setQuestion(e.target.value)} \n          required \n        />\n      </label>\n\n      <div>\n        Opciones:\n        {options.map((opt, idx) => (\n          <div key={idx}>\n            <input\n              type=\"text\"\n              value={opt}\n              onChange={e => handleOptionChange(idx, e.target.value)}\n              required\n              placeholder={`Opción ${idx + 1}`}\n            />\n            <label>\n              <input\n                type=\"radio\"\n                name=\"correctOption\"\n                checked={correctIndex === idx}\n                onChange={() => setCorrectIndex(idx)}\n              />\n              Correcta\n            </label>\n          </div>\n        ))}\n      </div>\n\n      {error && <div className=\"error-message\">{error}</div>}\n\n      <div className=\"manual-question-actions\">\n        <button type=\"button\" onClick={onCancel} disabled={loading}>\n          Cancelar\n        </button>\n        <button type=\"submit\" disabled={loading}>\n          {loading ? 'Guardando...' : 'Guardar pregunta'}\n        </button>\n      </div>\n    </form>\n  );\n};\n\nexport default ManualQuestionForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}